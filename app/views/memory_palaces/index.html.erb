<div class="container">
  <div class="header-row">
    <h1>Memory Palaces</h1>
    <%= link_to 'Create New Palace', new_memory_palace_path, class: "btn-primary" %>
  </div>

  <div class="grid">
    <% @memory_palaces.each do |mp| %>
      <div class="card palace-card no-hover">
        <div class="card-header">
          <h3><%= mp.name %></h3>
          <span class="locus-count"><%= mp.loci.count %> Loci</span>
        </div>
        <p><%= mp.description.presence || "No description provided." %></p>
        
        <div class="card-actions">
          <%= link_to "Open", mp, class: "btn-secondary", style: "flex: 1; text-align: center; width: 100%;" %>
          <%= button_to mp, method: :delete, class: "btn-danger icon-only", form: { style: "display:inline" }, data: { turbo_confirm: "Are you sure you want to delete this Memory Palace?" } do %>
             <i class="fas fa-trash"></i>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>
  
  <% if @memory_palaces.empty? %>
    <div class="empty-state">
      <p>You haven't created any Memory Palaces yet.</p>
      <%= link_to "Create Your First Palace", new_memory_palace_path, class: "cta-button" %>
    </div>
  <% end %>
</div>

<style>
  .header-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
  
  .palace-card { 
    display: flex; 
    flex-direction: column; 
    justify-content: space-between; 
    min-height: 160px;
    padding: 20px;
  }
  
  .no-hover:hover { transform: none !important; box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06) !important; }

  .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
  .locus-count { background: #E2E8F0; padding: 2px 8px; border-radius: 12px; font-size: 0.75rem; font-weight: bold; color: #475569; }
  
  .card-actions { display: flex; gap: 10px; margin-top: auto; align-items: stretch; }
  
  .btn-danger { background: none; border: 1px solid #FECACA; color: #EF4444; border-radius: 8px; cursor: pointer; height: auto; display: flex; align-items: center; justify-content: center; }
  .btn-danger:hover { background: #FEF2F2; }
  .icon-only { padding: 0 15px; } /* Adjust padding for icon button */
  
  .empty-state { text-align: center; padding: 50px; color: #64748B; }
</style>
